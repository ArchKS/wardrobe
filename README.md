# 我的衣橱 - Wardrobe Manager

一个现代化的衣服管理和展示系统，帮你记录、管理和分析你试穿过的衣服。

## 功能特性

- **照片墙展示** - 支持三种视图模式：
  - 网格视图：经典的网格布局展示
  - 时间线视图：按日期分组展示
  - 分类视图：按衣服类别分组展示

- **智能筛选** - 多维度筛选：
  - 按品牌筛选
  - 按类别筛选（上衣、裤子、鞋子等）
  - 按风格筛选（休闲、运动、商务等）
  - 按材质筛选
  - 按满意度评分筛选

- **数据分析** - 可视化统计：
  - 品牌分布饼图
  - 类别分布柱状图
  - 风格统计
  - 满意度分布
  - 月度试穿趋势

- **编辑功能** - 方便管理：
  - 点击卡片编辑衣服信息
  - 修改品牌、类别、风格等标签
  - 添加备注和评价
  - 导出 JSON 数据到本地

- **拖拽合并** - 智能整合：
  - 拖拽一个卡片到另一个卡片上进行合并
  - 自动合并两个条目的所有图片
  - 保留目标条目的所有信息（品牌、类别等）
  - 源条目自动删除，避免重复

- **安全删除** - 两步删除机制：
  - 鼠标悬停卡片显示删除按钮（红色垃圾桶图标）
  - 第一步：网页上删除只标记条目，不删除本地图片文件
  - 第二步：导出 JSON 后，运行 `npm run sync` 时自动清理本地图片
  - 防止误删文件，给用户恢复的机会

## 技术栈

- **前端框架**: React 19 + TypeScript
- **构建工具**: Vite 7
- **样式**: TailwindCSS 4
- **图表**: Recharts
- **图标**: Lucide React
- **日期处理**: date-fns

## 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

访问 http://localhost:3000

**自动扫描图片**：启动时会自动扫描 `public/images/` 目录，发现新图片会自动添加到数据中（默认标签为"待补充"），你可以在网页上编辑完善信息。

### 清理未使用的文件

```bash
npm run clean
```

**功能说明**：
1. 删除 `wardrobe.json` 中标记为删除的项（isDelete=1）
2. 删除 `public/images/` 目录中未被使用的图片文件
3. 自动更新 JSON 文件

**使用场景**：
- 定期清理不需要的图片文件，释放存储空间
- 在导出更新的 JSON 后，运行此命令删除标记删除的项和相关图片
- 清理从外部复制进来但未添加到数据中的图片

### 构建生产版本

```bash
npm run build
```

### 预览生产版本

```bash
npm run preview
```

## 数据结构

衣服数据存储在 `src/data/wardrobe.json` 文件中，格式如下：

```json
{
  "items": [
    {
      "id": "001",
      "images": ["图片URL1", "图片URL2"],
      "time": "2024-03-15",
      "location": "北京三里屯",
      "brand": "Uniqlo",
      "category": "上衣",
      "style": ["休闲", "简约"],
      "material": "纯棉",
      "satisfaction": 4,
      "color": "白色",
      "price": 199,
      "tags": ["基础款", "百搭"],
      "notes": "非常舒适，适合日常穿着"
    }
  ]
}
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 唯一标识符 |
| images | string[] | 是 | 图片URL数组 |
| time | string | 是 | 试穿日期 (YYYY-MM-DD) |
| location | string | 是 | 试穿地点 |
| brand | string | 是 | 品牌 |
| category | string | 是 | 类别（上衣/裤子/鞋子等） |
| style | string[] | 是 | 风格标签数组 |
| material | string | 是 | 材质 |
| satisfaction | number | 是 | 满意度 (1-5) |
| color | string | 否 | 颜色 |
| price | number | 否 | 价格 |
| tags | string[] | 否 | 自定义标签 |
| notes | string | 否 | 备注 |

## 如何使用

1. **添加图片**：将衣服照片放到 `public/images/` 目录下（支持 jpg、png、gif、webp、heic 等格式）
2. **自动导入**：运行 `npm run dev` 或 `npm run sync`，系统会自动扫描新图片并添加到数据中
3. **编辑信息**：在网页上点击衣服卡片的编辑按钮，完善品牌、类别、风格等信息
4. **合并图片**：如果同一件衣服有多个条目，可以拖拽一个卡片到另一个上进行合并（鼠标悬停时会显示拖拽图标）
5. **删除条目**：
   - 网页上点击红色垃圾桶图标标记删除
   - 导出 JSON 并替换本地文件
   - 运行 `npm run clean` 清理标记删除的项和本地图片
6. **清理文件**：运行 `npm run clean` 删除未使用的图片文件，释放存储空间
7. **筛选浏览**：点击右下角的蓝色悬浮按钮打开筛选面板
8. **切换视图**：点击右上角的图标切换不同的展示模式（网格/时间线/分类）
9. **查看分析**：点击右上角的图表图标查看数据分析和统计
10. **导出数据**：点击"导出数据"按钮下载更新后的 JSON 文件，然后替换 `src/data/wardrobe.json`

## 项目结构

```
wardrobe/
├── src/
│   ├── components/        # React 组件
│   │   ├── Analytics.tsx  # 数据分析面板
│   │   ├── ClothingCard.tsx  # 衣服卡片
│   │   ├── EditModal.tsx  # 编辑弹窗
│   │   ├── Filters.tsx    # 筛选器
│   │   ├── Gallery.tsx    # 照片墙
│   │   └── Header.tsx     # 头部导航
│   ├── data/
│   │   └── wardrobe.json  # 衣服数据
│   ├── types/
│   │   └── index.ts       # TypeScript 类型定义
│   ├── App.tsx            # 主应用组件
│   ├── main.tsx           # 入口文件
│   └── index.css          # 全局样式
├── scripts/
│   └── sync-images.js     # 图片自动扫描脚本
├── public/
│   └── images/            # 图片资源（将你的衣服照片放这里）
├── package.json
└── vite.config.ts
```

## 常见问题

**Q: 如何添加新衣服？**

A: 最简单的方式：
1. 将照片复制到 `public/images/` 目录
2. 运行 `npm run sync` 或重启 `npm run dev`
3. 系统会自动检测新图片并创建条目（默认标签为"待补充"）
4. 在网页上点击编辑按钮，完善衣服的详细信息

也可以手动编辑 `src/data/wardrobe.json`，或使用在线图片 URL。

**Q: 图片会重复添加吗？**

A: 不会。扫描脚本会检查图片是否已经存在于数据中，只会添加新图片。

**Q: 如何合并多个条目的图片？**

A: 很简单！
1. 将鼠标悬停在要移动的卡片上（会显示拖拽图标）
2. 按住鼠标左键拖动到目标卡片上
3. 当目标卡片出现蓝色边框时，释放鼠标
4. 确认合并，两个条目的图片会合并到目标条目，源条目自动删除

**Q: 合并后能撤销吗？**

A: 合并操作会立即生效，建议定期使用"导出数据"功能备份。如需撤销，可以从备份中恢复。

**Q: 如何删除不需要的衣服？**

A: 删除分两步：
1. 在网页上点击卡片的红色垃圾桶图标，确认删除（此时只是标记删除，本地图片还在）
2. 点击"导出数据"按钮，下载并替换 `src/data/wardrobe.json`
3. 运行 `npm run clean`，系统会自动删除标记删除的项和对应的本地图片文件

**Q: 为什么不直接删除图片文件？**

A: 两步删除机制更安全：
- 第一步只是标记，给你反悔的机会
- 如果误删，可以在导出前编辑 JSON 恢复（将 isDelete 改为 0）
- 只有确认导出并运行 `npm run clean` 后，才会真正删除本地文件

**Q: 删除后能恢复吗？**

A: 在运行 `npm run clean` 之前可以恢复：
- 如果只是网页上删除，还没导出：直接刷新页面即可
- 如果已导出但未运行 clean：编辑 JSON 文件，将 isDelete 字段改为 0
- 如果已运行 clean：图片文件已被删除，只能从备份恢复

**Q: 修改数据后如何保存？**

A: 点击网页上的"导出数据"按钮，下载 JSON 文件，然后替换 `src/data/wardrobe.json` 文件

**Q: 可以部署到网上吗？**

A: 可以！运行 `npm run build`，然后将 `dist` 目录部署到：
- GitHub Pages
- Vercel
- Netlify
- 任何支持静态网站的托管服务

## 贡献

欢迎提出建议和改进！

## 许可

ISC
